name: Deploy Dashboard

on:
  workflow_dispatch:  # Manual trigger

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          persist-credentials: false
      
      # Ensure we have the dashboard HTML
      - name: Copy dashboard HTML
        run: |
          # If your dashboard HTML is in a different file or location, adjust this line
          cp dashboard/index.html index.html || echo "Dashboard HTML already at root"
      
      - name: Create sample trade history
        run: |
          echo '[
            {
              "timestamp": "2025-03-20T12:00:00.000Z",
              "symbol": "BTCUSDT",
              "action": "buy",
              "originalAmount": 100,
              "orderSize": "100.00",
              "orderId": "12345678",
              "status": "success"
            },
            {
              "timestamp": "2025-03-20T13:30:00.000Z",
              "symbol": "BTCUSDT",
              "action": "sell",
              "originalAmount": 0.002,
              "orderSize": "0.002",
              "orderId": "12345679",
              "status": "success"
            },
            {
              "timestamp": "2025-03-21T09:15:00.000Z",
              "symbol": "SOLUSDT",
              "action": "buy",
              "originalAmount": 200,
              "orderSize": "200.00",
              "orderId": "12345680",
              "status": "success"
            }
          ]' > trade_history.json
      
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .
          clean: true  # Changed to true to remove old files
