name: Deploy Dashboard

on:
  workflow_dispatch:  # Manual trigger
  schedule:
    - cron: '0 */6 * * *'  # Run every 6 hours

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      
      - name: Create dashboard files
        run: |
          # Create index.html in the root
          echo '<!DOCTYPE html><html><head><title>Trading Dashboard</title></head><body><h1>Trading Dashboard</h1><p>Dashboard initialization. This will be updated with real content soon.</p></body></html>' > index.html
          
          # Create empty trade history if it doesn't exist
          if [ ! -f "trade_history.json" ]; then
            echo "[]" > trade_history.json
          fi
      
      - name: Deploy to gh-pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          personal_token: ${{ secrets.DASHBOARD_PAT }}
          publish_dir: ./
          destination_dir: ./
          exclude_assets: '.github,**/.git**'
